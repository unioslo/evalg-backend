#!/usr/bin/env groovy

pipeline {
    agent { label 'docker' }
    stages {
        stage ('Build evalg image') {
            steps {
                sh "docker build \
                    -t '${project}/valg-backend' \
                    -f Dockerfile-staging ."
                sh "docker tag '${project}/valg-backend' '${project}/valg-backend:${image_version}'"
            }
        }
        stage ('Push image to Harbor') {
            steps {
                sh "docker push '${project}/valg-backend'"
            }
        }
    }
//    post {
//        cleanup {
//            sh 'rm -vrf build dist'
//        }   
//    }   
}

